function stringPath(t,e){e=e.replace(/^\./,"");for(var i=e.split("."),n=0,r=i.length;r>n;++n){var s=i[n];if(!(s in t))return;t=t[s]}return t}!function(t){t.module("daveawb.angularModels",[])}(angular),function(t){function e(){return function(t,e){var i,n=this;i=t&&_.has(t,"constructor")?t.constructor:function(){return n.apply(this,arguments)},_.extend(i,n,e);var r=function(){this.constructor=i};return r.prototype=n.prototype,i.prototype=new r,t&&_.extend(i.prototype,t),i.__super__=n.prototype,i}}t.module("daveawb.angularModels").factory("daveawbExtender",e)}(angular),function(t){function e(t,e){return i.extend=t,i.http=e,i}t.module("daveawb.angularModels").factory("daveawbCollection",e),e.$inject=["daveawbExtender","$http"];var i=function(t,e){e||(e={}),e.model&&(this.model=e.model),this.models=[],this._byId={},this.set(t,e)};i.prototype={model:null,set:function(t,e){var i=this,n=this.model,r=!_.isArray(t);return e||(e={}),t=r?t?[t]:[]:t.slice(),_.each(t,function(t){var r=i.get(t);if(r)r.set(t,e);else{var s=new n(t,e);i.models.push(s),s.isNew()?i._byId[s.uid]=s:i._byId[i.modelId(s)]=s}}),this},get:function(t){if(null==t)return void 0;var e=this.modelId(this._isModel(t)?t.attributes:t);return this._byId[t]||this._byId[e]||this._byId[t.uid]},modelId:function(t){return t[this.model.prototype.idAttribute||"id"]},_isModel:function(t){return t instanceof this.model},fetch:function(t){var e=this,n=this.url;if(!n)throw new Error("A URL must be defined.");return this.preFetch(),t&&(n=n.split("/"),n.push(t),n=n.join("/")),i.http.get(n).then(function(t){t=e.postFetch(t);var i=e.path?stringPath(t.data,e.path):t.data;return e.set(i),e})},preFetch:function(){},postFetch:function(t){return t}}}(angular),function(t){function e(t){return i.extend=t,i}function i(t,e){var i=t||{};this.attributes={},this.options=e,this.isGuarded=_.isArray(this.guarded),this.isFillable=!this.isGuarded&&_.isArray(this.fillable),i=_.defaults({},i,_.result(this,"defaults")),this.set(i,e)}t.module("daveawb.angularModels").service("daveawbModel",e),e.$inject=["daveawbExtender"],i.prototype={cast:{},changed:[],uid:null,defaults:{},fillable:null,guarded:null,getters:{},idAttribute:"id",setters:{},set:function(t,e,i){var n;"object"==typeof t?(n=t,i=e):(n={})[t]=e,i||(i={});var r=i.unset,s=this.attributes,u=_.keys(n),o=[];this._previousAttributes=_.clone(this.attributes),this.isGuarded?u=_.difference(u,this.guarded):this.isFillable&&(u=_.intersection(this.fillable,u)),n[this.idAttribute]&&(this[this.idAttribute]=n[this.idAttribute]);for(var a in n)if(-1!==u.indexOf(a)){if(o.push(a),this.setters[a]&&"function"==typeof this.setters[a]&&(n[a]=this.setters[a](n[a])),this.cast[a]){var d="castTo"+this.cast[a];"function"==typeof this[d]&&(n[a]=this[d](n[a]))}r?delete s[a]:s[a]=n[a]}return this.uid?this.changed=this.changed.concat(o):this.uid=_.uniqueId("u"),this},get:function(t){var e=this.getters[t];return e&&"function"==typeof e?e(this.attributes[t]):this.attributes[t]},has:function(t){return null!=this.get(t)},hasChanged:function(t){var e=this.changed;return-1!==e.indexOf(t)},isNew:function(){return!this.attributes[this.idAttribute]},unset:function(t,e){var i=t;return"object"!=typeof i&&((i={})[t]=void 0),this.set(i,_.extend({},e,{unset:!0}))},castToInt:function(t){return parseInt(t,10)},castToString:function(t){return t.toString()},castToBool:function(t){return"false"===t||"0"===t?!1:!!t},castToDate:function(t){return new Date(t)}}}(angular);